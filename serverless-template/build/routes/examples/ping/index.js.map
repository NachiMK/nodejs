{"version":3,"sources":["../../../../src/routes/examples/ping/index.js"],"names":["ping","event","env","npm_package_version","STAGE","versions","node","process","result","message","showENV","showEvent","params","eventHeadersHost","headers","Host","HTTPRequestPassingThroughHixmeDomain","includes","serviceIsRuningLocally","isOffline","isSafeToDisplayEnvVariables"],"mappings":";;;;;;;;;;;AAAA;;;;AACA;;;;AAOO,MAAMA,sBAAO;AAAA,6CAGlB,WAAOC,KAAP,EAAiB;AACf,UAAM;AAEJC,WAAK,EAAEC,mBAAF,EAAuBC,KAAvB,KAAiC,EAFlC;AAGJC,gBAAU,EAAEC,IAAF,KAAW;AAHjB,QAIFC,OAJJ;;AAMA,UAAMF,WAAW,EAAEC,IAAF,EAAQH,mBAAR,EAAjB;;AAEAF,UAAMO,MAAN,GAAe;AACbC,eAAS,OADI;AAEbL,WAFa;AAGbC;AAHa,KAAf;;AAOA,UAAM,EAAEK,OAAF,EAAWC,SAAX,KAAyBV,MAAMW,MAArC;AACA,QAAI,8BAAkBD,SAAlB,CAAJ,EAAkC;AAChCV,YAAMO,MAAN,CAAaP,KAAb,GAAqBA,KAArB;AACD;;AAED,UAAMY,mBAAmBZ,MAAMa,OAAN,IAAiBb,MAAMa,OAAN,CAAcC,IAAxD;AACA,UAAMC,uCAAuCH,oBAAoBA,iBAAiBI,QAAjB,CAA0B,WAA1B,CAAjE;AACA,UAAMC,yBAAyB,CAACF,oCAAD,IAAyCf,MAAMkB,SAA9E;;AAEA,UAAMC,8BAA8B,kBAAWF,sBAA/C;;AAGA,QAAIE,+BAA+B,8BAAkBV,OAAlB,CAAnC,EAA+D;AAC7DT,YAAMO,MAAN,CAAaN,GAAb,GAAmBK,QAAQL,GAA3B;AACD;AACF,GAlCiB;;AAAA;AAAA;AAAA;AAAA,mBAAb","file":"index.js","sourcesContent":["import ware from 'warewolf'\nimport {\n  after,\n  before,\n  isProd,\n  queryStringIsTrue,\n} from '../../../utils'\n\nexport const ping = ware(\n  before,\n\n  async (event) => {\n    const {\n      // eslint-disable-next-line camelcase\n      env: { npm_package_version, STAGE } = {},\n      versions: { node } = {},\n    } = process\n\n    const versions = { node, npm_package_version }\n\n    event.result = {\n      message: 'pong!',\n      STAGE,\n      versions,\n    }\n\n    // if `showEvent` query-string is set, then add the entire event\n    const { showENV, showEvent } = event.params\n    if (queryStringIsTrue(showEvent)) {\n      event.result.event = event\n    }\n\n    const eventHeadersHost = event.headers && event.headers.Host\n    const HTTPRequestPassingThroughHixmeDomain = eventHeadersHost && eventHeadersHost.includes('hixme.com')\n    const serviceIsRuningLocally = !HTTPRequestPassingThroughHixmeDomain || event.isOffline\n    // NOTE: `event.isOffline` is a serverless-added boolean and it's quite helpful\n    const isSafeToDisplayEnvVariables = !isProd && serviceIsRuningLocally\n\n    // if `showENV` query-string is set, then add all environment variables\n    if (isSafeToDisplayEnvVariables && queryStringIsTrue(showENV)) {\n      event.result.env = process.env\n    }\n  },\n\n  after,\n)\n"]}