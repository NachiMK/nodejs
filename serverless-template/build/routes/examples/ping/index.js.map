{"version":3,"sources":["../../../../src/routes/examples/ping/index.js"],"names":["ping","event","env","npm_package_version","STAGE","versions","node","process","result","message","showENV","showEvent","params","eventHeadersHost","headers","Host","HTTPRequestPassingThroughHixmeDomain","includes","serviceIsRuningLocally","isOffline","isSafeToDisplayEnvVariables"],"mappings":";;;;;;;AAAA;;;;AACA;;;;AAOO,MAAMA,sBAAO,uCAGlB,MAAOC,KAAP,IAAiB;AACf,QAAM;AAEJC,SAAK,EAAEC,mBAAF,EAAuBC,KAAvB,KAAiC,EAFlC;AAGJC,cAAU,EAAEC,IAAF,KAAW;AAHjB,MAIFC,OAJJ;;AAMA,QAAMF,WAAW,EAAEC,IAAF,EAAQH,mBAAR,EAAjB;;AAEAF,QAAMO,MAAN,GAAe;AACbC,aAAS,OADI;AAEbL,SAFa;AAGbC;AAHa,GAAf;;AAOA,QAAM,EAAEK,OAAF,EAAWC,SAAX,KAAyBV,MAAMW,MAArC;AACA,MAAI,8BAAkBD,SAAlB,CAAJ,EAAkC;AAChCV,UAAMO,MAAN,CAAaP,KAAb,GAAqBA,KAArB;AACD;;AAED,QAAMY,mBAAmBZ,MAAMa,OAAN,IAAiBb,MAAMa,OAAN,CAAcC,IAAxD;AACA,QAAMC,uCAAuCH,oBAAoBA,iBAAiBI,QAAjB,CAA0B,WAA1B,CAAjE;AACA,QAAMC,yBAAyB,CAACF,oCAAD,IAAyCf,MAAMkB,SAA9E;;AAEA,QAAMC,8BAA8B,kBAAWF,sBAA/C;;AAGA,MAAIE,+BAA+B,8BAAkBV,OAAlB,CAAnC,EAA+D;AAC7DT,UAAMO,MAAN,CAAaN,GAAb,GAAmBK,QAAQL,GAA3B;AACD;AACF,CAlCiB,eAAb","file":"index.js","sourcesContent":["import ware from 'warewolf'\nimport {\n  after,\n  before,\n  isProd,\n  queryStringIsTrue,\n} from '../../../utils'\n\nexport const ping = ware(\n  before,\n\n  async (event) => {\n    const {\n      // eslint-disable-next-line camelcase\n      env: { npm_package_version, STAGE } = {},\n      versions: { node } = {},\n    } = process\n\n    const versions = { node, npm_package_version }\n\n    event.result = {\n      message: 'pong!',\n      STAGE,\n      versions,\n    }\n\n    // if `showEvent` query-string is set, then add the entire event\n    const { showENV, showEvent } = event.params\n    if (queryStringIsTrue(showEvent)) {\n      event.result.event = event\n    }\n\n    const eventHeadersHost = event.headers && event.headers.Host\n    const HTTPRequestPassingThroughHixmeDomain = eventHeadersHost && eventHeadersHost.includes('hixme.com')\n    const serviceIsRuningLocally = !HTTPRequestPassingThroughHixmeDomain || event.isOffline\n    // NOTE: `event.isOffline` is a serverless-added boolean and it's quite helpful\n    const isSafeToDisplayEnvVariables = !isProd && serviceIsRuningLocally\n\n    // if `showENV` query-string is set, then add all environment variables\n    if (isSafeToDisplayEnvVariables && queryStringIsTrue(showENV)) {\n      event.result.env = process.env\n    }\n  },\n\n  after,\n)\n"]}