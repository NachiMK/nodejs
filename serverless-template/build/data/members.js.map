{"version":3,"sources":["../../src/data/members.js"],"names":["upsertMemberGraph","getMember","getParent","getChildren","getMemberPhones","member","upsertedGraph","knex","trx","query","allowUpsert","upsertGraph","memberID","eager","findById","parent","$relatedQuery","children","phones"],"mappings":";;;;;QAIsBA,iB,GAAAA,iB;QAUAC,S,GAAAA,S;QASAC,S,GAAAA,S;QAOAC,W,GAAAA,W;QAOAC,e,GAAAA,e;;AApCtB;;AACA;;;;;;AAEO,eAAeJ,iBAAf,CAAiCK,MAAjC,EAAyC;AAC9C,QAAMC,gBAAgB,MAAM,4BAAY,iBAAOC,IAAP,EAAZ,EAA2BC,OACrD,iBAAOC,KAAP,CAAaD,GAAb,EACGE,WADH,CACe,qCADf,EAEGC,WAFH,CAEeN,MAFf,CAD0B,CAA5B;;AAMA,SAAOC,aAAP;AACD;;AAEM,eAAeL,SAAf,CAAyBW,QAAzB,EAAmCC,KAAnC,EAA0C;AAC/C,QAAMR,SAAS,MAAM,iBAClBI,KADkB,GAElBI,KAFkB,CAEZA,KAFY,EAGlBC,QAHkB,CAGTF,QAHS,CAArB;;AAKA,SAAOP,MAAP;AACD;;AAEM,eAAeH,SAAf,CAAyBU,QAAzB,EAAmC;AACxC,QAAMP,SAAS,MAAM,iBAAOI,KAAP,GAAeK,QAAf,CAAwBF,QAAxB,CAArB;AACA,QAAMG,SAAS,MAAMV,OAAOW,aAAP,CAAqB,QAArB,CAArB;;AAEA,SAAOD,MAAP;AACD;;AAEM,eAAeZ,WAAf,CAA2BS,QAA3B,EAAqC;AAC1C,QAAMP,SAAS,MAAM,iBAAOI,KAAP,GAAeK,QAAf,CAAwBF,QAAxB,CAArB;AACA,QAAMK,WAAW,MAAMZ,OAAOW,aAAP,CAAqB,UAArB,CAAvB;;AAEA,SAAOC,QAAP;AACD;;AAEM,eAAeb,eAAf,CAA+BQ,QAA/B,EAAyC;AAC9C,QAAMP,SAAS,MAAM,iBAAOI,KAAP,GAAeK,QAAf,CAAwBF,QAAxB,CAArB;AACA,QAAMM,SAAS,MAAMb,OAAOW,aAAP,CAAqB,QAArB,CAArB;;AAEA,SAAOE,MAAP;AACD","file":"members.js","sourcesContent":["\nimport { transaction } from 'objection';\nimport Member from './models/member';\n\nexport async function upsertMemberGraph(member) {\n  const upsertedGraph = await transaction(Member.knex(), trx => (\n    Member.query(trx)\n      .allowUpsert('[Phones, Children.[Phones], Parent]')\n      .upsertGraph(member)\n  ));\n\n  return upsertedGraph;\n}\n\nexport async function getMember(memberID, eager) {\n  const member = await Member\n    .query()\n    .eager(eager)\n    .findById(memberID);\n\n  return member;\n}\n\nexport async function getParent(memberID) {\n  const member = await Member.query().findById(memberID);\n  const parent = await member.$relatedQuery('Parent');\n\n  return parent;\n}\n\nexport async function getChildren(memberID) {\n  const member = await Member.query().findById(memberID);\n  const children = await member.$relatedQuery('Children');\n\n  return children;\n}\n\nexport async function getMemberPhones(memberID) {\n  const member = await Member.query().findById(memberID);\n  const phones = await member.$relatedQuery('Phones');\n\n  return phones;\n}\n\n"]}