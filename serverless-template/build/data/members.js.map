{"version":3,"sources":["../../src/data/members.js"],"names":["upsertMemberGraph","getMember","getParent","getChildren","getMemberPhones","member","upsertedGraph","Member","knex","trx","query","allowUpsert","upsertGraph","memberID","eager","findById","parent","$relatedQuery","children","phones"],"mappings":";;;;;QAGsBA,iB,GAAAA,iB;QAUAC,S,GAAAA,S;QAQAC,S,GAAAA,S;QAOAC,W,GAAAA,W;QAOAC,e,GAAAA,e;;AAnCtB;;AACA;;;;;;AAEO,eAAeJ,iBAAf,CAAiCK,MAAjC,EAAyC;AAC9C,QAAMC,gBAAgB,MAAM,4BAAYC,iBAAOC,IAAP,EAAZ,EAA4BC,GAAD,IACrDF,iBAAOG,KAAP,CAAaD,GAAb,EACGE,WADH,CACe,qCADf,EAEGC,WAFH,CAEeP,MAFf,CAD0B,CAA5B;;AAMA,SAAOC,aAAP;AACD;;AAEM,eAAeL,SAAf,CAAyBY,QAAzB,EAAmCC,KAAnC,EAA0C;AAC/C,QAAMT,SAAS,MAAME,iBAAOG,KAAP,GAClBI,KADkB,CACZA,KADY,EAElBC,QAFkB,CAETF,QAFS,CAArB;;AAIA,SAAOR,MAAP;AACD;;AAEM,eAAeH,SAAf,CAAyBW,QAAzB,EAAmC;AACxC,QAAMR,SAAS,MAAME,iBAAOG,KAAP,GAAeK,QAAf,CAAwBF,QAAxB,CAArB;AACA,QAAMG,SAAS,MAAMX,OAAOY,aAAP,CAAqB,QAArB,CAArB;;AAEA,SAAOD,MAAP;AACD;;AAEM,eAAeb,WAAf,CAA2BU,QAA3B,EAAqC;AAC1C,QAAMR,SAAS,MAAME,iBAAOG,KAAP,GAAeK,QAAf,CAAwBF,QAAxB,CAArB;AACA,QAAMK,WAAW,MAAMb,OAAOY,aAAP,CAAqB,UAArB,CAAvB;;AAEA,SAAOC,QAAP;AACD;;AAEM,eAAed,eAAf,CAA+BS,QAA/B,EAAyC;AAC9C,QAAMR,SAAS,MAAME,iBAAOG,KAAP,GAAeK,QAAf,CAAwBF,QAAxB,CAArB;AACA,QAAMM,SAAS,MAAMd,OAAOY,aAAP,CAAqB,QAArB,CAArB;;AAEA,SAAOE,MAAP;AACD","file":"members.js","sourcesContent":["import { transaction } from 'objection';\nimport Member from './models/member';\n\nexport async function upsertMemberGraph(member) {\n  const upsertedGraph = await transaction(Member.knex(), (trx) =>\n    Member.query(trx)\n      .allowUpsert('[Phones, Children.[Phones], Parent]')\n      .upsertGraph(member)\n  );\n\n  return upsertedGraph;\n}\n\nexport async function getMember(memberID, eager) {\n  const member = await Member.query()\n    .eager(eager)\n    .findById(memberID);\n\n  return member;\n}\n\nexport async function getParent(memberID) {\n  const member = await Member.query().findById(memberID);\n  const parent = await member.$relatedQuery('Parent');\n\n  return parent;\n}\n\nexport async function getChildren(memberID) {\n  const member = await Member.query().findById(memberID);\n  const children = await member.$relatedQuery('Children');\n\n  return children;\n}\n\nexport async function getMemberPhones(memberID) {\n  const member = await Member.query().findById(memberID);\n  const phones = await member.$relatedQuery('Phones');\n\n  return phones;\n}\n"]}